import numpy as np
import time
import matplotlib.pyplot as plt
from Arm_Lib import Arm_Device

# Initialize Arm
Arm = Arm_Device()
time.sleep(0.2)

# Path 1: Task Space Z-axis (paste from MATLAB output)
q_path1 = np.array([
    [90.000000, 90.000000, 90.000000, 90.000000, 90.000000],
    [74.200684, 90.124547, 89.750905, 90.124547, 105.799316],
    [74.225121, 106.029049, 57.941901, 106.029049, 105.774879],
    [74.061691, 106.154253, 57.691493, 106.154253, 105.938309],
    [74.125525, 106.278512, 57.442976, 106.278512, 105.874475],
    [74.050113, 106.401848, 57.196305, 106.401848, 105.949887],
    [74.083141, 106.524281, 56.951438, 106.524281, 105.916859],
    [74.037195, 106.645832, 56.708336, 106.645832, 105.962805],
    [74.030320, 106.766520, 56.466960, 106.766520, 105.969680],
    [74.023278, 106.886364, 56.227272, 106.886364, 105.976722],
    [74.052268, 107.005382, 55.989237, 107.005382, 105.947732],
    [74.008728, 107.123591, 55.752819, 107.123591, 105.991272],
    [74.001312, 107.241008, 55.517985, 107.241008, 105.998688],
    [73.957302, 107.357649, 55.284702, 107.357649, 106.042698],
    [73.986341, 107.473530, 55.052940, 107.473530, 106.013659],
    [73.978849, 107.588666, 54.822667, 107.588666, 106.021151],
    [73.971339, 107.703072, 54.593855, 107.703072, 106.028661],
    [73.963918, 107.816763, 54.366475, 107.816763, 106.036082],
    [73.956526, 107.929750, 54.140499, 107.929750, 106.043474],
    [73.730506, 108.042049, 53.915903, 108.042049, 106.269494],
    [73.735255, 108.153671, 53.692659, 108.153671, 106.264745],
    [73.740973, 108.264629, 53.470742, 108.264629, 106.259027],
    [74.024485, 108.374938, 53.250123, 108.374938, 105.975515],
    [74.054914, 108.484608, 53.030784, 108.484608, 105.945086],
    [73.960208, 108.593649, 52.812702, 108.593649, 106.039792],
    [74.097005, 108.702073, 52.595853, 108.702073, 105.902995],
    [74.038900, 108.809891, 52.380218, 108.809891, 105.961100],
    [74.033568, 108.917113, 52.165774, 108.917113, 105.966432],
    [74.028244, 109.023749, 51.952501, 109.023749, 105.971756],
    [74.022940, 109.129810, 51.740381, 109.129810, 105.977060],
    [74.017661, 109.235304, 51.529393, 109.235304, 105.982339],
    [74.012457, 109.340241, 51.319519, 109.340241, 105.987543],
    [74.043424, 109.444630, 51.110740, 109.444630, 105.956576],
    [74.037878, 109.548480, 50.903040, 109.548480, 105.962122],
    [73.994072, 109.651800, 50.696400, 109.651800, 106.005928],
    [73.992112, 109.754598, 50.490804, 109.754598, 106.007888],
    [73.987168, 109.856882, 50.286236, 109.856882, 106.012832],
    [73.946300, 109.958660, 50.082679, 109.958660, 106.053700],
    [74.016543, 110.059940, 49.880119, 110.059940, 105.983457],
    [73.972844, 110.160730, 49.678540, 110.160730, 106.027156],
    [73.968215, 110.261037, 49.477927, 110.261037, 106.031785],
    [73.791147, 110.360867, 49.278267, 110.360867, 106.208853],
    [73.758565, 110.460228, 49.079545, 110.460228, 106.241435],
    [73.711253, 110.559126, 48.881747, 110.559126, 106.288747],
    [73.783073, 110.657570, 48.684860, 110.657570, 106.216927],
    [73.720110, 110.755565, 48.488870, 110.755565, 106.279890],
    [73.774874, 110.853117, 48.293766, 110.853117, 106.225126],
    [73.698081, 110.950233, 48.099534, 110.950233, 106.301919],
    [73.787816, 111.046919, 47.906162, 111.046919, 106.212184],
    [73.758122, 111.143181, 47.713638, 111.143181, 106.241878],
    [73.772131, 111.239024, 47.521951, 111.239024, 106.227869],
    [73.820239, 111.334455, 47.331090, 111.334455, 106.179761],
    [73.887060, 111.429479, 47.141043, 111.429479, 106.112940],
    [73.860303, 111.524101, 46.951799, 111.524101, 106.139697],
    [73.823897, 111.618326, 46.763348, 111.618326, 106.176103],
    [73.866085, 111.712160, 46.575679, 111.712160, 106.133915],
    [73.932875, 111.805609, 46.388782, 111.805609, 106.067125],
    [73.891175, 111.898676, 46.202648, 111.898676, 106.108825],
    [73.994030, 111.991367, 46.017266, 111.991367, 106.005970],
    [73.869956, 112.083686, 45.832628, 112.083686, 106.130044],
    [73.916598, 112.175639, 45.648722, 112.175639, 106.083402],
    [73.846114, 112.267229, 45.465542, 112.267229, 106.153886],
    [73.913250, 112.358462, 45.283076, 112.358462, 106.086750],
    [73.907877, 112.449341, 45.101318, 112.449341, 106.092123],
    [73.905054, 112.539871, 44.920257, 112.539871, 106.094946],
    [73.936917, 112.630057, 44.739886, 112.630057, 106.063083],
    [73.981062, 112.719902, 44.560197, 112.719902, 106.018938],
    [73.897017, 112.809410, 44.381181, 112.809410, 106.102983],
    [73.975782, 112.898585, 44.202830, 112.898585, 106.024218],
    [73.840343, 112.987432, 44.025136, 112.987432, 106.159657],
    [73.844228, 113.075954, 43.848093, 113.075954, 106.155772],
    [73.841990, 113.164154, 43.671692, 113.164154, 106.158010],
    [73.885129, 113.252037, 43.495925, 113.252037, 106.114871],
    [73.882782, 113.339607, 43.320787, 113.339607, 106.117218],
    [73.898572, 113.426878, 43.146244, 113.426878, 106.101428],
    [73.879643, 113.513842, 42.972316, 113.513842, 106.120357],
    [73.876650, 113.600503, 42.798995, 113.600503, 106.123350],
    [73.992266, 113.686863, 42.626273, 113.686863, 106.007734],
    [73.870626, 113.772927, 42.454146, 113.772927, 106.129374],
    [73.867667, 113.858697, 42.282606, 113.858697, 106.132333],
    [73.864735, 113.944177, 42.111646, 113.944177, 106.135265],
    [73.861878, 114.029369, 41.941261, 114.029369, 106.138122],
    [73.810340, 114.114278, 41.771445, 114.114278, 106.189660],
    [73.938276, 114.198905, 41.602191, 114.198905, 106.061724],
    [73.887385, 114.283253, 41.433494, 114.283253, 106.112615],
    [73.851160, 114.367327, 41.265347, 114.367327, 106.148840],
    [73.848718, 114.451127, 41.097745, 114.451127, 106.151282],
    [73.846152, 114.534659, 40.930683, 114.534659, 106.153848],
    [73.964419, 114.617923, 40.764154, 114.617923, 106.035581],
    [73.881700, 114.700923, 40.598153, 114.700923, 106.118300],
    [73.916779, 114.783662, 40.432676, 114.783662, 106.083221],
    [73.880697, 114.866142, 40.267716, 114.866142, 106.119303],
    [73.800441, 114.948366, 40.103269, 114.948366, 106.199559],
    [73.879720, 115.030335, 39.939329, 115.030335, 106.120280],
    [73.879207, 115.112054, 39.775892, 115.112054, 106.120793],
    [73.878711, 115.193524, 39.612952, 115.193524, 106.121289],
    [73.878231, 115.274747, 39.450505, 115.274747, 106.121769],
    [73.877768, 115.355727, 39.288546, 115.355727, 106.122232],
    [73.877267, 115.436465, 39.127071, 115.436465, 106.122733],
    [73.874715, 115.516963, 38.966073, 115.516963, 106.125285],
    [73.876323, 115.597225, 38.805550, 115.597225, 106.123677]
])

[90.00, 90.00, 0.00, 90.00, 90.00],
[90.00, 90.89, 0.00, 89.86, 90.00],
[90.00, 91.77, 0.00, 89.72, 90.00],
[90.00, 92.65, 0.00, 89.59, 90.00],
[90.00, 93.53, 0.00, 89.47, 90.00],
[90.00, 94.40, 0.00, 89.36, 90.00],
[90.00, 95.27, 0.00, 89.25, 90.00],
[90.00, 96.14, 0.00, 89.16, 90.00],
[90.00, 97.00, 0.00, 89.07, 90.00],
[90.00, 97.85, 0.00, 88.99, 90.00],
[90.00, 98.71, 0.00, 88.93, 90.00],
[90.00, 99.55, 0.00, 88.87, 90.00],
[90.00, 100.39, 0.00, 88.82, 90.00],
[90.00, 101.22, 0.00, 88.79, 90.00],
[90.00, 102.05, 0.00, 88.77, 90.00],
[90.00, 102.86, 0.00, 88.76, 90.00],
[90.00, 103.67, 0.00, 88.76, 90.00],
[90.00, 104.47, 0.00, 88.77, 90.00],
[90.00, 105.27, 0.00, 88.80, 90.00],
[90.00, 106.05, 0.00, 88.84, 90.00],
[90.00, 106.82, 0.00, 88.90, 90.00],
[90.00, 107.59, 0.00, 88.97, 90.00],
[90.00, 108.34, 0.00, 89.05, 90.00],
[90.00, 109.09, 0.00, 89.15, 90.00],
[90.00, 109.82, 0.00, 89.27, 90.00],
[90.00, 110.54, 0.00, 89.40, 90.00],
[90.00, 111.25, 0.00, 89.54, 90.00],
[90.00, 111.95, 0.00, 89.70, 90.00],
[90.00, 112.64, 0.00, 89.88, 90.00],
[90.00, 113.32, 0.00, 90.07, 90.00],
[90.00, 113.98, 0.00, 90.28, 90.00],
[90.00, 114.63, 0.00, 90.51, 90.00],
[90.00, 115.27, 0.00, 90.75, 90.00],
[90.00, 115.90, 0.00, 91.01, 90.00],
[90.00, 116.51, 0.00, 91.29, 90.00],
[90.00, 117.11, 0.00, 91.58, 90.00],
[90.00, 117.70, 0.00, 91.89, 90.00],
[90.00, 118.27, 0.01, 92.21, 90.00],
[90.00, 118.81, 0.05, 92.53, 90.00],
[90.00, 119.32, 0.13, 92.84, 90.00],
[90.00, 119.80, 0.24, 93.14, 90.00],
[90.00, 120.26, 0.39, 93.44, 90.00],
[90.00, 120.69, 0.57, 93.73, 90.00],
[90.00, 121.09, 0.78, 94.02, 90.00],
[90.00, 121.46, 1.02, 94.30, 90.00],
[90.00, 121.80, 1.30, 94.58, 90.00],
[90.00, 122.12, 1.61, 94.86, 90.00],
[90.00, 122.40, 1.95, 95.13, 90.00],
[90.00, 122.66, 2.33, 95.40, 90.00],
[90.00, 122.89, 2.73, 95.66, 90.00],
[90.00, 123.09, 3.18, 95.92, 90.00],
[90.00, 123.26, 3.65, 96.18, 90.00],
[90.00, 123.40, 4.16, 96.43, 90.00],
[90.00, 123.51, 4.70, 96.67, 90.00],
[90.00, 123.59, 5.28, 96.91, 90.00],
[90.00, 123.65, 5.89, 97.15, 90.00],
[90.00, 123.67, 6.54, 97.38, 90.00],
[90.00, 123.66, 7.22, 97.60, 90.00],
[90.00, 123.63, 7.94, 97.82, 90.00],
[90.00, 123.56, 8.70, 98.03, 90.00],
[90.00, 123.46, 9.49, 98.23, 90.00],
[90.00, 123.34, 10.33, 98.42, 90.00],
[90.00, 123.18, 11.20, 98.61, 90.00],
[90.00, 122.99, 12.11, 98.79, 90.00],
[90.00, 122.77, 13.07, 98.95, 90.00],
[90.00, 122.51, 14.07, 99.11, 90.00],
[90.00, 122.23, 15.11, 99.25, 90.00],
[90.00, 121.91, 16.20, 99.38, 90.00],
[90.00, 121.55, 17.34, 99.49, 90.00],
[90.00, 121.16, 18.53, 99.59, 90.00],
[90.00, 120.74, 19.77, 99.67, 90.00],
[90.00, 120.28, 21.07, 99.73, 90.00],
[90.00, 119.78, 22.43, 99.78, 90.00],
[90.00, 119.25, 23.84, 99.80, 90.00],
[90.00, 118.67, 25.32, 99.79, 90.00],
[90.00, 118.05, 26.88, 99.76, 90.00],
[90.00, 117.39, 28.50, 99.70, 90.00],
[90.00, 116.67, 30.21, 99.60, 90.00],
[90.00, 115.91, 32.00, 99.48, 90.00],
[90.00, 115.10, 33.88, 99.30, 90.00],
[90.00, 114.22, 35.87, 99.09, 90.00],
[90.00, 113.29, 37.97, 98.82, 90.00],
[90.00, 112.28, 40.20, 98.50, 90.00],
[90.00, 111.20, 42.57, 98.11, 90.00],
[90.00, 110.03, 45.11, 97.64, 90.00],
[90.00, 108.76, 47.84, 97.08, 90.00],
[90.00, 107.37, 50.80, 96.42, 90.00],
[90.00, 105.84, 54.03, 95.62, 90.00],
[90.00, 104.13, 57.61, 94.64, 90.00],
[90.00, 102.18, 61.66, 93.44, 90.00],
[90.00, 99.90, 66.36, 91.92, 90.00],
[90.00, 97.11, 72.08, 89.89, 90.00],
[90.00, 93.35, 79.73, 86.90, 90.00],
[90.00, 86.62, 93.32, 80.94, 90.00],
[90.00, 108.05, 50.58, 103.15, 90.00],
[90.00, 106.24, 54.31, 102.12, 90.00],
[90.00, 104.21, 58.49, 100.87, 90.00],
[90.00, 101.87, 63.29, 99.32, 90.00],
[90.00, 99.06, 69.03, 97.29, 90.00],
[90.00, 95.41, 76.43, 94.44, 90.00],
[90.00, 89.68, 88.00, 89.50, 90.00],
# Execution parameters
dt = 0.05  # 50 ms loop time

print(f"\nPath: Task Space Z-axis")
print(f"Total waypoints: {len(q_path1)}")
print(f"Loop time: {dt} s")
print(f"Estimated total time: {len(q_path1) * dt:.2f} s")

# Confirm execution
user_input = input("\nPress Enter to execute path or type 'q' to abort: ").lower()
if user_input == 'q':
    print("Aborted.")
    Arm.Arm_serial_servo_write6(90, 90, 90, 90, 90, 90, 1000)
    exit()

# Initialize logging arrays
n_steps = len(q_path1)
time_log = []
q_commanded = np.zeros((n_steps, 5))
q_measured = np.zeros((n_steps, 5))

print("\n" + "="*70)
print("EXECUTING PATH...")
print("="*70)
print(f"{'Step':<6} {'Time(s)':<10} {'Commanded Angles':<40} {'Status'}")
print("-"*70)

# Execute path
t0 = time.time()
for k in range(n_steps):
    q_cmd = q_path1[k]
    q_commanded[k] = q_cmd
    Arm.Arm_serial_servo_write6(
        int(q_cmd[0]), int(q_cmd[1]), int(q_cmd[2]), 
        int(q_cmd[3]), int(q_cmd[4]), 90, 400
    )
    time.sleep(400)
    for i in range(5):
        q_measured[k, i] = Arm.Arm_serial_servo_read(i + 1)
    # Log time
    t = time.time() - t0
    time_log.append(t)

print(f"Path execution complete in {time_log[-1]:.3f} seconds\n")

# Return to home position
print("Returning to home position...")
Arm.Arm_serial_servo_write6(90, 90, 90, 90, 90, 90, 1500)
time.sleep(1.5)

# Compute errors
print("\n" + "="*70)
print("          ERROR ANALYSIS")
print("="*70)

# Joint errors
joint_errors = q_commanded - q_measured
joint_error_rms = np.sqrt(np.mean(joint_errors**2, axis=0))
joint_error_max = np.max(np.abs(joint_errors), axis=0)

print("\nJoint-Space Errors:")
print(f"{'Joint':<8} {'RMS Error (deg)':<20} {'Max Error (deg)':<20}")
print("-"*70)
for i in range(5):
    print(f"Joint {i+1:<2} {joint_error_rms[i]:<20.4f} {joint_error_max[i]:<20.4f}")

print(f"\nOverall RMS Error: {np.sqrt(np.mean(joint_errors**2)):.4f} deg")
print(f"Overall Max Error: {np.max(np.abs(joint_errors)):.4f} deg")

# Compute lambda tracking
q0 = q_path1[0]
qf = q_path1[-1]
delta_q = qf - q0
delta_q_norm2 = np.dot(delta_q, delta_q)

if delta_q_norm2 > 1e-6:
    lambda_cmd = np.linspace(0, 1, n_steps)
    lambda_meas = np.dot(q_measured - q0, delta_q) / delta_q_norm2
    
    lambda_error = lambda_meas - lambda_cmd
    print(f"\nPath Parameter (λ) Tracking:")
    print(f"  Mean λ error: {np.mean(lambda_error):.6f}")
    print(f"  RMS λ error:  {np.sqrt(np.mean(lambda_error**2)):.6f}")
    print(f"  Max λ error:  {np.max(np.abs(lambda_error)):.6f}")

# Summary statistics
print(f"\nFinal Position:")
print(f"  Commanded: [{qf[0]:.2f}, {qf[1]:.2f}, {qf[2]:.2f}, {qf[3]:.2f}, {qf[4]:.2f}]")
print(f"  Measured:  [{q_measured[-1,0]:.2f}, {q_measured[-1,1]:.2f}, {q_measured[-1,2]:.2f}, {q_measured[-1,3]:.2f}, {q_measured[-1,4]:.2f}]")
print(f"  Error:     [{joint_errors[-1,0]:.2f}, {joint_errors[-1,1]:.2f}, {joint_errors[-1,2]:.2f}, {joint_errors[-1,3]:.2f}, {joint_errors[-1,4]:.2f}]")

print("\n" + "="*70)
print("          GENERATING PLOTS...")
print("="*70 + "\n")

# Plot 1: Joint angles vs time
fig, axes = plt.subplots(5, 1, figsize=(10, 12), sharex=True)
fig.suptitle('Commanded vs Measured Joint Angles', fontsize=14, fontweight='bold')

for i in range(5):
    axes[i].plot(time_log, q_commanded[:, i], 'b-', linewidth=2, label='Commanded')
    axes[i].plot(time_log, q_measured[:, i], 'r--', linewidth=1.5, label='Measured')
    axes[i].set_ylabel(f'θ{i+1} (deg)', fontsize=10)
    axes[i].grid(True, alpha=0.3)
    axes[i].legend(loc='best')

axes[-1].set_xlabel('Time (s)', fontsize=10)
plt.tight_layout()
plt.show()

# Plot 2: Joint errors vs time
fig, axes = plt.subplots(5, 1, figsize=(10, 12), sharex=True)
fig.suptitle('Joint Angle Tracking Errors', fontsize=14, fontweight='bold')

for i in range(5):
    axes[i].plot(time_log, joint_errors[:, i], 'r-', linewidth=1.5)
    axes[i].axhline(y=0, color='k', linestyle='--', alpha=0.3)
    axes[i].set_ylabel(f'Error θ{i+1} (deg)', fontsize=10)
    axes[i].grid(True, alpha=0.3)

axes[-1].set_xlabel('Time (s)', fontsize=10)
plt.tight_layout()
plt.show()

# Plot 3: Lambda tracking
if delta_q_norm2 > 1e-6:
    plt.figure(figsize=(10, 6))
    plt.plot(time_log, lambda_cmd, 'b-', linewidth=2, label='Commanded λ(t)')
    plt.plot(time_log, lambda_meas, 'r--', linewidth=1.5, label='Measured λ(t)')
    plt.xlabel('Time (s)', fontsize=12)
    plt.ylabel('λ(t)', fontsize=12)
    plt.title('Path Parameter Tracking', fontsize=14, fontweight='bold')
    plt.grid(True, alpha=0.3)
    plt.legend(fontsize=11)
    plt.tight_layout()
    plt.show()

print("All plots displayed. Close plot windows to continue.")
print("\nExecution complete!")


'''
q_path1 = np.array([
    [90.000000, 90.000000, 90.000000, 90.000000, 90.000000],
    [74.200684, 90.124547, 89.750905, 90.124547, 105.799316],
    [74.225121, 106.029049, 57.941901, 106.029049, 105.774879],
    [74.061691, 106.154253, 57.691493, 106.154253, 105.938309],
    [74.125525, 106.278512, 57.442976, 106.278512, 105.874475],
    [74.050113, 106.401848, 57.196305, 106.401848, 105.949887],
    [74.083141, 106.524281, 56.951438, 106.524281, 105.916859],
    [74.037195, 106.645832, 56.708336, 106.645832, 105.962805],
    [74.030320, 106.766520, 56.466960, 106.766520, 105.969680],
    [74.023278, 106.886364, 56.227272, 106.886364, 105.976722],
    [74.052268, 107.005382, 55.989237, 107.005382, 105.947732],
    [74.008728, 107.123591, 55.752819, 107.123591, 105.991272],
    [74.001312, 107.241008, 55.517985, 107.241008, 105.998688],
    [73.957302, 107.357649, 55.284702, 107.357649, 106.042698],
    [73.986341, 107.473530, 55.052940, 107.473530, 106.013659],
    [73.978849, 107.588666, 54.822667, 107.588666, 106.021151],
    [73.971339, 107.703072, 54.593855, 107.703072, 106.028661],
    [73.963918, 107.816763, 54.366475, 107.816763, 106.036082],
    [73.956526, 107.929750, 54.140499, 107.929750, 106.043474],
    [73.730506, 108.042049, 53.915903, 108.042049, 106.269494],
    [73.735255, 108.153671, 53.692659, 108.153671, 106.264745],
    [73.740973, 108.264629, 53.470742, 108.264629, 106.259027],
    [74.024485, 108.374938, 53.250123, 108.374938, 105.975515],
    [74.054914, 108.484608, 53.030784, 108.484608, 105.945086],
    [73.960208, 108.593649, 52.812702, 108.593649, 106.039792],
    [74.097005, 108.702073, 52.595853, 108.702073, 105.902995],
    [74.038900, 108.809891, 52.380218, 108.809891, 105.961100],
    [74.033568, 108.917113, 52.165774, 108.917113, 105.966432],
    [74.028244, 109.023749, 51.952501, 109.023749, 105.971756],
    [74.022940, 109.129810, 51.740381, 109.129810, 105.977060],
    [74.017661, 109.235304, 51.529393, 109.235304, 105.982339],
    [74.012457, 109.340241, 51.319519, 109.340241, 105.987543],
    [74.043424, 109.444630, 51.110740, 109.444630, 105.956576],
    [74.037878, 109.548480, 50.903040, 109.548480, 105.962122],
    [73.994072, 109.651800, 50.696400, 109.651800, 106.005928],
    [73.992112, 109.754598, 50.490804, 109.754598, 106.007888],
    [73.987168, 109.856882, 50.286236, 109.856882, 106.012832],
    [73.946300, 109.958660, 50.082679, 109.958660, 106.053700],
    [74.016543, 110.059940, 49.880119, 110.059940, 105.983457],
    [73.972844, 110.160730, 49.678540, 110.160730, 106.027156],
    [73.968215, 110.261037, 49.477927, 110.261037, 106.031785],
    [73.791147, 110.360867, 49.278267, 110.360867, 106.208853],
    [73.758565, 110.460228, 49.079545, 110.460228, 106.241435],
    [73.711253, 110.559126, 48.881747, 110.559126, 106.288747],
    [73.783073, 110.657570, 48.684860, 110.657570, 106.216927],
    [73.720110, 110.755565, 48.488870, 110.755565, 106.279890],
    [73.774874, 110.853117, 48.293766, 110.853117, 106.225126],
    [73.698081, 110.950233, 48.099534, 110.950233, 106.301919],
    [73.787816, 111.046919, 47.906162, 111.046919, 106.212184],
    [73.758122, 111.143181, 47.713638, 111.143181, 106.241878],
    [73.772131, 111.239024, 47.521951, 111.239024, 106.227869],
    [73.820239, 111.334455, 47.331090, 111.334455, 106.179761],
    [73.887060, 111.429479, 47.141043, 111.429479, 106.112940],
    [73.860303, 111.524101, 46.951799, 111.524101, 106.139697],
    [73.823897, 111.618326, 46.763348, 111.618326, 106.176103],
    [73.866085, 111.712160, 46.575679, 111.712160, 106.133915],
    [73.932875, 111.805609, 46.388782, 111.805609, 106.067125],
    [73.891175, 111.898676, 46.202648, 111.898676, 106.108825],
    [73.994030, 111.991367, 46.017266, 111.991367, 106.005970],
    [73.869956, 112.083686, 45.832628, 112.083686, 106.130044],
    [73.916598, 112.175639, 45.648722, 112.175639, 106.083402],
    [73.846114, 112.267229, 45.465542, 112.267229, 106.153886],
    [73.913250, 112.358462, 45.283076, 112.358462, 106.086750],
    [73.907877, 112.449341, 45.101318, 112.449341, 106.092123],
    [73.905054, 112.539871, 44.920257, 112.539871, 106.094946],
    [73.936917, 112.630057, 44.739886, 112.630057, 106.063083],
    [73.981062, 112.719902, 44.560197, 112.719902, 106.018938],
    [73.897017, 112.809410, 44.381181, 112.809410, 106.102983],
    [73.975782, 112.898585, 44.202830, 112.898585, 106.024218],
    [73.840343, 112.987432, 44.025136, 112.987432, 106.159657],
    [73.844228, 113.075954, 43.848093, 113.075954, 106.155772],
    [73.841990, 113.164154, 43.671692, 113.164154, 106.158010],
    [73.885129, 113.252037, 43.495925, 113.252037, 106.114871],
    [73.882782, 113.339607, 43.320787, 113.339607, 106.117218],
    [73.898572, 113.426878, 43.146244, 113.426878, 106.101428],
    [73.879643, 113.513842, 42.972316, 113.513842, 106.120357],
    [73.876650, 113.600503, 42.798995, 113.600503, 106.123350],
    [73.992266, 113.686863, 42.626273, 113.686863, 106.007734],
    [73.870626, 113.772927, 42.454146, 113.772927, 106.129374],
    [73.867667, 113.858697, 42.282606, 113.858697, 106.132333],
    [73.864735, 113.944177, 42.111646, 113.944177, 106.135265],
    [73.861878, 114.029369, 41.941261, 114.029369, 106.138122],
    [73.810340, 114.114278, 41.771445, 114.114278, 106.189660],
    [73.938276, 114.198905, 41.602191, 114.198905, 106.061724],
    [73.887385, 114.283253, 41.433494, 114.283253, 106.112615],
    [73.851160, 114.367327, 41.265347, 114.367327, 106.148840],
    [73.848718, 114.451127, 41.097745, 114.451127, 106.151282],
    [73.846152, 114.534659, 40.930683, 114.534659, 106.153848],
    [73.964419, 114.617923, 40.764154, 114.617923, 106.035581],
    [73.881700, 114.700923, 40.598153, 114.700923, 106.118300],
    [73.916779, 114.783662, 40.432676, 114.783662, 106.083221],
    [73.880697, 114.866142, 40.267716, 114.866142, 106.119303],
    [73.800441, 114.948366, 40.103269, 114.948366, 106.199559],
    [73.879720, 115.030335, 39.939329, 115.030335, 106.120280],
    [73.879207, 115.112054, 39.775892, 115.112054, 106.120793],
    [73.878711, 115.193524, 39.612952, 115.193524, 106.121289],
    [73.878231, 115.274747, 39.450505, 115.274747, 106.121769],
    [73.877768, 115.355727, 39.288546, 115.355727, 106.122232],
    [73.877267, 115.436465, 39.127071, 115.436465, 106.122733],
    [73.874715, 115.516963, 38.966073, 115.516963, 106.125285],
    [73.876323, 115.597225, 38.805550, 115.597225, 106.123677]
])'''